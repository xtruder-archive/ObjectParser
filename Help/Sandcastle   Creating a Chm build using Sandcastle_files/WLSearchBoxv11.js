var WLSearchBoxStandardConfiguration={"global":{"serverDNS":"search.live.com","market":"en-US","jsonFormCode":"LSBSOW"},"appearance":{"autoHideTopControl":false,"width":600,"height":400,"theme":"Blue"},"scopes":[{"type":"web","caption":"Web","searchParam":""}]};var WLSearchBoxTheme=null;var WLSearchBoxThemeBlue={"BorderColor":"#9db2b4","ScopeButtonBackImage":"scopebarbtnbg_blue.jpg","ScopeBarBackImage":"scopebarbg_blue.jpg"};var WLSearchBoxThemeGreen={"BorderColor":"#a3b49d","ScopeButtonBackImage":"scopebarbtnbg_green.jpg","ScopeBarBackImage":"scopebarbg_green.jpg"};var WLSearchBoxThemeRed={"BorderColor":"#a3b49d","ScopeButtonBackImage":"scopebarbtnbg_red.jpg","ScopeBarBackImage":"scopebarbg_red.jpg"};var WLSearchBoxThemeYellow={"BorderColor":"#bbb195","ScopeButtonBackImage":"scopebarbtnbg_yellow.jpg","ScopeBarBackImage":"scopebarbg_yellow.jpg"};var WLSearchBoxSettings={"DefaultDiv":{"style.color":"'#444444'","style.fontSize":"WLSearchBoxTheme.FontSize","style.fontFamily":"WLSearchBoxTheme.FontFamily"},"DefaultA":{"style.color":"'#0066a7'","style.fontSize":"WLSearchBoxTheme.FontSize","style.fontFamily":"WLSearchBoxTheme.FontFamily","style.display":"'inline'","style.textDecoration":"'none'","target":"'_blank'"},"SpaceDiv":{"style.fontSize":"'1px'","style.fontFamily":"WLSearchBoxTheme.FontFamily","style.display":"'inline'","innerHTML":"' '"},"FloatPane":{"callFunction":{"SetId":["'WLFloatPaneDiv'"],"Resize":["WLSearchBoxConfiguration.appearance.width","WLSearchBoxConfiguration.appearance.height"],"SetBorderWidth":["'1px'"],"SetBorderColor":["WLSearchBoxTheme.BorderColor"]},"setProperty":{"style.color":"'#444444'","style.fontSize":"WLSearchBoxTheme.FontSize","style.fontFamily":"WLSearchBoxTheme.FontFamily","style.fontWeight":"'normal'","style.textAlign":"'left'","style.lineHeight":"'normal'"}},"ShadowPane":{"callFunction":{"SetId":["'WLFloatPaneShadowDiv'"],"Resize":["WLSearchBoxConfiguration.appearance.width","WLSearchBoxConfiguration.appearance.height"]},"setProperty":{"style.backgroundColor":"'gray'"}},"ScopeBar":{"callFunction":{"SetId":["'WLScopeBarDiv'"],"SetDock":["WLSearch.UI.DockStyle.Top"],"Resize":["0","'30px'"],"SetBorderWidth":["'1px'","'bottom'"],"SetBorderColor":["WLSearchBoxTheme.BorderColor"]},"setProperty":{"style.backgroundImage":"\"url('http://\" + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + \"/siteowner/\" + WLSearchBoxTheme.ScopeBarBackImage + \"')\""}},"FootBar":{"callFunction":{"SetId":["'WLFootDiv'"],"SetDock":["WLSearch.UI.DockStyle.Bottom"],"Resize":["0","'29px'"],"SetBorderWidth":["'1px'","'top'"],"SetBorderColor":["WLSearchBoxTheme.BorderColor"]},"GetOwnA":{"id":"'WLGetOwnA'","style.fontWeight":"700","style.styleFloat":"'left'","style.cssFloat":"'left'","style.padding":"'8px'","style.whiteSpace":"'nowrap'","href":"g_WLSearchBoxConfig.CFG_HOMEPAGELINK","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_GET_OWN"},"CopyRightDiv":{"id":"'WLCopyRightDiv'","style.color":"'#aaaaaa'","style.textDecoration":"'none'","style.styleFloat":"'right'","style.cssFloat":"'right'","style.padding":"'8px'"},"PrivacyA":{"id":"'WLSearchBoxPrivacyA'","style.color":"'#aaaaaa'","href":"g_WLSearchBoxConfig.CFG_PRIVACYLINK","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_PRIVACY"},"LegalA":{"id":"'WLSearchBoxLegalA'","style.color":"'#aaaaaa'","href":"g_WLSearchBoxConfig.CFG_LEGALLINK","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_LEGAL"},"FeedbackA":{"id":"'WLSearchBoxFeedbackA'","style.color":"'#aaaaaa'","href":"g_WLSearchBoxConfig.CFG_FEEDBACKLINK","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_FEEDBACK"}},"ScopeBarElements":{"CloseDiv":{"style.styleFloat":"'right'","style.cssFloat":"'right'"},"CloseImg":{"id":"'WLCloseImage'","src":"'http://' + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + '/siteowner/x_normal.gif'","alt":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_CLOSE","style.margin":"'10px 10px 0px 0px'","style.width":"'10px'","style.height":"'10px'","style.clear":"'both'","style.cursor":"'pointer'"},"ScopeButtonOuterDiv":{"style.backgroundImage":"\"url('http://\" + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + \"/siteowner/\" + WLSearchBoxTheme.ScopeButtonBackImage + \"')\"","style.borderRight":"'1px solid'","style.borderRightColor":"WLSearchBoxTheme.BorderColor","style.styleFloat":"'left'","style.cssFloat":"'left'","style.padding":"'3px 3px'","style.cursor":"'pointer'"},"ScopeButtonInnerDiv":{"tabIndex":"0","style.color":"'#444444'","style.padding":"'5px 12px'","style.fontSize":"'12px'","style.fontWeight":"'normal'","style.backgroundColor":"'transparent'","style.border":"'none'"},"ScopeButtonInnerDivSelect":{"style.color":"'#444444'","style.padding":"'4px 12px'","style.fontSize":"'12px'","style.fontWeight":"700","style.backgroundColor":"'#fff'","style.border":"'1px solid'","style.borderColor":"WLSearchBoxTheme.BorderColor"}},"ResultArea":{"callFunction":{"SetId":["'WLResultAreaDiv'"],"SetDock":["WLSearch.UI.DockStyle.Fill"]}},"AdsView":{"callFunction":{"SetId":["'WLAdsViewDiv'"],"SetDock":["WLSearch.UI.DockStyle.Right"],"Resize":["'186px'","0"],"SetBorderWidth":["'1px'","'left'"],"SetBorderColor":["WLSearchBoxTheme.BorderColor"]},"SponsorDiv":{"style.margin":"'8px 0px 0px 8px'","style.textAlign":"'left'","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_SPONSORED_SITE"},"AdsCallbackCGif":{"style.width":"'0px'","style.height":"'0px'","style.display":"'none'"}},"ResultView":{"callFunction":{"SetId":["'WLResultViewDiv'"],"SetDock":["WLSearch.UI.DockStyle.Fill"]}},"ResultHeader":{"callFunction":{"SetId":["'WLResultHeaderDiv'"],"SetDock":["WLSearch.UI.DockStyle.Top"],"Resize":["0","'29px'"],"SetBorderWidth":["'1px'","'bottom'"],"SetBorderColor":["WLSearchBoxTheme.BorderColor"]},"ResultNumberDiv":{"id":"'WLResultHeaderNumberDiv'","style.styleFloat":"'left'","style.cssFloat":"'left'","style.padding":"'8px'"},"LogoImg":{"id":"'WLResultHeaderLogoDiv'","alt":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_LIVE_SEARCH","style.styleFloat":"'right'","style.cssFloat":"'right'","src":"'http://' + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_LOGOIMG","style.margin":"'0px 2px 0px 0px'","style.display":"'block'","style.width":"'79px'","style.height":"'26px'"}},"ResultContent":{"callFunction":{"SetId":["'WLResultContentDiv'"],"SetDock":["WLSearch.UI.DockStyle.Fill"]},"setProperty":{"style.overflowY":"'auto'","style.scrollbar3dLightColor":"'#d4d0c8'","style.scrollbarArrowColor":"'#000000'","style.scrollbarBaseColor":"'#d4d0c8'","style.scrollbarTrackColor":"'#eceae6'","style.scrollbarDarkShadowColor":"'#404040'","style.scrollbarFaceColor":"'#d4d0c8'","style.scrollbarHighlightColor":"'#fff'","style.scrollbarShadowColor":"'#808080'"},"SpellCheckDiv":{"id":"'WLResultSpellCheckView'","style.margin":"'0px'","style.borderBottom":"'1px solid #f1f1f1'","style.backgroundColor":"'#ffffab'"},"SpellCheckHint":{"id":"'WLResultSpellHint'","style.padding":"'8px 0px 8px 8px'","style.fontWeight":"700"},"SpellCheckLink":{"id":"'WLSearchBoxSpellCheckLink'","style.color":"'#0066a7'","style.fontWeight":"'normal'","style.textDecoration":"'underline'","style.display":"'inline'","style.cursor":"'pointer'","style.lineHeight":"'148%'"},"WebResultItem":{"style.margin":"'8px 8px 12px 8px'"},"WebResultTitle":{"style.lineHeight":"'148%'","style.fontSize":"'13px'","style.textDecoration":"'underline'"},"WebResultDesc":{"style.lineHeight":"'148%'"},"WebResultUrl":{"style.lineHeight":"'148%'","style.color":"'#36a200'","style.wordWrap":"'break-word'"},"EmptyQueryDiv":{"style.fontSize":"'12px'","style.margin":"'8px 8px 12px 8px'","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_EMPTY_QUERY"},"NoResultHint1Div":{"id":"'WLSearchBoxNoResultHint'","style.margin":"'8px'","style.borderBottom":"'solid 1px #f1f1f1'"},"NoResultNoFindDiv":{"id":"'WLSearchBoxNoResultNoFind'","style.marginBottom":"'8px'"},"QueryStringDiv":{"id":"'WLSearchQueryStringDiv'","style.display":"'inline'","style.fontWeight":"700","style.lineHeight":"'148%'"},"NoResultTryDiv":{"id":"'WLNoResultTryThisQueryDiv'","style.marginBottom":"'8px'","style.display":"'block'"},"NoResultTryA":{"id":"'WLNoResultTryThisQueryA'","style.textDecoration":"'underline'","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_TRY_LS"},"NoResultHint2Div":{"id":"'WLSearchBoxNoResultOtherRes'","style.margin":"'0px 8px'"},"NoResultOtherResDiv":{"style.fontSize":"'13px'","style.margin":"'8px 8px 8px 0px'","style.fontWeight":"700","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_OTHER_RES"},"NoResultSendA":{"style.textDecoration":"'underline'"},"MoreResultDiv":{"style.margin":"'8px'"},"MoreResultA":{"style.textDecoration":"'underline'","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_MORE_RESULTS"}},"ResultFooter":{"callFunction":{"SetId":["'WLResultFooterDiv'"],"SetDock":["WLSearch.UI.DockStyle.Bottom"],"Resize":["0","'29px'"],"SetBorderWidth":["'1px'","'top'"],"SetBorderColor":["WLSearchBoxTheme.BorderColor"]},"TryThisQueryA":{"id":"'WLTryThisQueryA'","style.styleFloat":"'left'","style.cssFloat":"'left'","style.padding":"'8px'","style.whiteSpace":"'nowrap'","innerHTML":"g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_TRY_LS"},"ResultPaginationDiv":{"style.styleFloat":"'right'","style.cssFloat":"'right'"},"ResultPageNumDiv":{"tabIndex":"0","style.border":"'1px solid #e6e6e6'","style.styleFloat":"'left'","style.cssFloat":"'left'","style.margin":"'5px 4px 5px 0px'","style.padding":"'0px 5px'","style.height":"'17px'","style.backgroundColor":"'#fff'","style.fontSize":"WLSearchBoxTheme.FontSize","style.textAlign":"'center'","style.color":"'#0066a7'","style.fontWeight":"'normal'","style.cursor":"'pointer'"},"ResultPageNumDivHover":{"style.border":"'1px solid #b7d8ee'","style.backgroundColor":"'#d2eaf6'","style.fontWeight":"'normal'"},"ResultPageNumDivSelect":{"style.border":"'1px solid #b7d8ee'","style.backgroundColor":"'#d2eaf6'","style.color":"'#444444'","style.fontWeight":"700"},"ResultPageNext":{"id":"'WLWebResultNextDiv'","style.width":"'20px'","style.padding":"'0px'","style.backgroundImage":"\"url('http://\" + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + \"/siteowner/pagenext_default.gif')\""},"ResultPageNextHover":{"style.backgroundImage":"\"url('http://\" + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + \"/siteowner/pagenext_active.gif')\""},"ResultPagePrevious":{"id":"'WLWebResultPreviousDiv'","style.width":"'20px'","style.padding":"'0px'","style.backgroundImage":"\"url('http://\" + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + \"/siteowner/pageprev_default.gif')\""},"ResultPagePreviousHover":{"style.backgroundImage":"\"url('http://\" + WLSearchBoxConfiguration.global.serverDNS + g_WLSearchBoxConfig.CFG_IMGPATH + \"/siteowner/pageprev_active.gif')\""}}};WLSearchBox=new Object();WLSearchBox.FloatPane=function(b,c,e){var m_this=this;var m_state={};m_state.config=e;m_state.settings=WLSearchBoxSettings;m_state.activeScope=0;m_state.firstShow=true;var Application=b;var shadowPane=new WLSearch.UI.Panel();var floatPane=new WLSearch.UI.Panel();var scopeBar=new WLSearch.UI.Panel();var footBar=new WLSearch.UI.Panel();var resultArea=new WLSearch.UI.Panel();var adsView=new WLSearch.UI.Panel();var resultView=new WLSearch.UI.Panel();var resultHeader=new WLSearch.UI.Panel();var resultContent=new WLSearch.UI.Panel();var resultFooter=new WLSearch.UI.Panel();var rgScopeButtonDivs=new Array();var elResultHeaderNumberDiv=h(m_state.settings.ResultHeader.ResultNumberDiv);var elTryThisQueryA=k(m_state.settings.ResultFooter.TryThisQueryA);var elResultContentDiv=h();var elAdsDiv=adsView.GetContents();var elAdsCallbackCGif=m(m_state.settings.AdsView.AdsCallbackCGif);var elSpellCheckDiv=h(m_state.settings.ResultContent.SpellCheckDiv);var elSpellCheckLink=h(m_state.settings.ResultContent.SpellCheckLink);var elEmptyQueryDiv=h(m_state.settings.ResultContent.EmptyQueryDiv);var elNoResultDiv=h();var elQueryStringDiv=h(m_state.settings.ResultContent.QueryStringDiv);var elNoResultTryDiv=h(m_state.settings.ResultContent.NoResultTryDiv);var elNoResultTryA=k(m_state.settings.ResultContent.NoResultTryA);var elMoreResultDiv=k(m_state.settings.ResultContent.MoreResultDiv);var elMoreResultA=k(m_state.settings.ResultContent.MoreResultA);var elResultPaginationDiv=h(m_state.settings.ResultFooter.ResultPaginationDiv);var elResultPreviousDiv=h(m_state.settings.ResultFooter.ResultPageNumDiv);var elResultNextDiv=h(m_state.settings.ResultFooter.ResultPageNumDiv);var rgResultPageNumDivs=new Array();var rgWebResultItem=new Array();var rgAdsResultItem=new Array();g();function g(){if(!Application||!c||!m_state.config||!m_state.settings)return;WLSearch.UI.SuspendLayout();floatPane.ApplySettings(m_state.settings.FloatPane);shadowPane.ApplySettings(m_state.settings.ShadowPane);scopeBar.ApplySettings(m_state.settings.ScopeBar);footBar.ApplySettings(m_state.settings.FootBar);resultArea.ApplySettings(m_state.settings.ResultArea);adsView.ApplySettings(m_state.settings.AdsView);resultView.ApplySettings(m_state.settings.ResultView);resultHeader.ApplySettings(m_state.settings.ResultHeader);resultContent.ApplySettings(m_state.settings.ResultContent);resultFooter.ApplySettings(m_state.settings.ResultFooter);floatPane.AppendChild(scopeBar);floatPane.AppendChild(footBar);floatPane.AppendChild(resultArea);resultArea.AppendChild(adsView);resultArea.AppendChild(resultView);resultView.AppendChild(resultHeader);resultView.AppendChild(resultFooter);resultView.AppendChild(resultContent);o(m_state.config.scopes);v();floatPane.Hide();shadowPane.Hide();shadowPane.GetWrapper().style.zIndex=65534;floatPane.GetWrapper().style.zIndex=65535;document.getElementsByTagName("body")[0].appendChild(shadowPane.GetWrapper());document.getElementsByTagName("body")[0].appendChild(floatPane.GetWrapper());WLSearch.UI.ResumeLayout();}function h(j){return WLSearch.UI.CreateDefaultElement("div",[m_state.settings.DefaultDiv,j]);}function k(l){return WLSearch.UI.CreateDefaultElement("a",[m_state.settings.DefaultA,l]);}function m(n){return WLSearch.UI.CreateDefaultElement("img",[m_state.settings.DefaultImg,n]);}function o(p){var settings=m_state.settings.ScopeBarElements;var elScopeDiv=scopeBar.GetContents();var elCloseDiv=h(settings.CloseDiv);var elCloseImg=m(settings.CloseImg);elCloseImg.onclick=function(){m_this.Hide();};elCloseDiv.appendChild(elCloseImg);elScopeDiv.appendChild(elCloseDiv);for(var i=0;i<p.length;i++){var elOuterDiv=h(settings.ScopeButtonOuterDiv);var elInnerDiv=h(settings.ScopeButtonInnerDiv);elOuterDiv.id="WLScopeButtonDiv"+i.toString();elInnerDiv.id="WLScopeButtonInnerDiv"+i.toString();elInnerDiv.innerHTML=p[i].caption;elOuterDiv.appendChild(elInnerDiv);elScopeDiv.appendChild(elOuterDiv);rgScopeButtonDivs.push(elInnerDiv);q(elOuterDiv,i);}WLSearch.UI.ApplyStyles(rgScopeButtonDivs[m_state.activeScope],settings.ScopeButtonInnerDivSelect);function q(r,s){r.onclick=function(){u();};r.onkeypress=function(t){if(WLSearch.Browser.IsFireFoxMozilla()){if(t.keyCode==13){t.preventDefault();u();}}else{if(window.event.keyCode==13){window.event.returnValue=false;u();}}};function u(){WLSearch.UI.ApplyStyles(rgScopeButtonDivs[m_state.activeScope],settings.ScopeButtonInnerDiv);m_state.activeScope=s;WLSearch.UI.ApplyStyles(rgScopeButtonDivs[m_state.activeScope],settings.ScopeButtonInnerDivSelect);Application.Search();}}}function v(){resultContent.GetContents().appendChild(elResultContentDiv);var elGetOwnA=k(m_state.settings.FootBar.GetOwnA);var elCopyRightDiv=h(m_state.settings.FootBar.CopyRightDiv);elCopyRightDiv.innerHTML=g_WLSearchBoxConfig.CFG_COPYRIGHT+"&nbsp;|&nbsp;";elCopyRightDiv.appendChild(k(m_state.settings.FootBar.PrivacyA));elCopyRightDiv.innerHTML+="&nbsp;|&nbsp;";elCopyRightDiv.appendChild(k(m_state.settings.FootBar.LegalA));elCopyRightDiv.innerHTML+="&nbsp;|&nbsp;";elCopyRightDiv.appendChild(k(m_state.settings.FootBar.FeedbackA));var elLogoImg=m(m_state.settings.ResultHeader.LogoImg);var hint=g_WLSearchBoxConfig.CFG_LIVESEARCHLINK.split("{0}");elTryThisQueryA.href=hint[0]+hint[1];var elSpellCheckHint=h(m_state.settings.ResultContent.SpellCheckHint);hint=g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_SPELL_HINT.split("{0}");elSpellCheckHint.appendChild(document.createTextNode(hint[0]));elSpellCheckHint.appendChild(elSpellCheckLink);elSpellCheckHint.appendChild(document.createTextNode(hint[1]));elSpellCheckDiv.appendChild(elSpellCheckHint);elResultContentDiv.appendChild(elSpellCheckDiv);elResultContentDiv.appendChild(elEmptyQueryDiv);var elNoResultHint1Div=h(m_state.settings.ResultContent.NoResultHint1Div);hint=g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_CONTAIN_NO.split("{0}");var elNoFind=h(m_state.settings.ResultContent.NoResultNoFindDiv);elNoFind.appendChild(document.createTextNode(hint[0]));elNoFind.appendChild(elQueryStringDiv);elNoFind.appendChild(document.createTextNode(hint[1]));elNoResultTryDiv.appendChild(elNoResultTryA);elNoResultHint1Div.appendChild(elNoFind);elNoResultHint1Div.appendChild(elNoResultTryDiv);var elNoResultHint2Div=h(m_state.settings.ResultContent.NoResultHint2Div);var elOtherResDiv=h(m_state.settings.ResultContent.NoResultOtherResDiv);hint=g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_CONTACT_US.split(/{[0-9]}/);var elResultHint=h();var elSendA=k(m_state.settings.ResultContent.NoResultSendA);elSendA.innerHTML=hint[1];elSendA.href=g_WLSearchBoxConfig.CFG_CONTACTUSLINK;elResultHint.appendChild(document.createTextNode(hint[0]));elResultHint.appendChild(elSendA);elResultHint.appendChild(document.createTextNode(hint[2]));elNoResultHint2Div.appendChild(elOtherResDiv);elNoResultHint2Div.appendChild(elResultHint);elNoResultDiv.appendChild(elNoResultHint1Div);elNoResultDiv.appendChild(elNoResultHint2Div);elResultContentDiv.appendChild(elNoResultDiv);for(var i=0;i<10;++i){var elItem=h(m_state.settings.ResultContent.WebResultItem);var elTitleDiv=h();var elTitle=k(m_state.settings.ResultContent.WebResultTitle);var elDesc=h(m_state.settings.ResultContent.WebResultDesc);var elUrl=h(m_state.settings.ResultContent.WebResultUrl);elTitleDiv.appendChild(elTitle);elItem.appendChild(elTitleDiv);elItem.appendChild(elDesc);elItem.appendChild(elUrl);elItem.id="WebResultItemDiv"+i;elResultContentDiv.appendChild(elItem);rgWebResultItem.push({"item":elItem,"title":elTitle,"description":elDesc,"url":elUrl});}elMoreResultDiv.appendChild(elMoreResultA);elResultContentDiv.appendChild(elMoreResultDiv);var footSetting=m_state.settings.ResultFooter;WLSearch.UI.ApplyStyles(elResultPreviousDiv,footSetting.ResultPagePrevious);elResultPaginationDiv.appendChild(elResultPreviousDiv);elResultPreviousDiv.style.display="none";for(var i=0;i<10;++i){var elDiv=h(footSetting.ResultPageNumDiv);elDiv.innerHTML=i;elDiv.id="WLWebResultPaginationDiv"+i;rgResultPageNumDivs.push(elDiv);elResultPaginationDiv.appendChild(elDiv);elDiv.style.display="none";}WLSearch.UI.ApplyStyles(elResultNextDiv,footSetting.ResultPageNext);elResultPaginationDiv.appendChild(elResultNextDiv);elResultNextDiv.style.display="none";footBar.GetContents().appendChild(elCopyRightDiv);footBar.GetContents().appendChild(elGetOwnA);resultHeader.GetContents().appendChild(elResultHeaderNumberDiv);resultHeader.GetContents().appendChild(elLogoImg);resultFooter.GetContents().appendChild(elResultPaginationDiv);resultFooter.GetContents().appendChild(elTryThisQueryA);var elSponsorDiv=h(m_state.settings.AdsView.SponsorDiv);elAdsDiv.appendChild(elSponsorDiv);for(var i=0;i<10;++i){var elItem=h(m_state.settings.ResultContent.WebResultItem);var elTitleDiv=h();var elTitle=k(m_state.settings.ResultContent.WebResultTitle);var elDesc=h(m_state.settings.ResultContent.WebResultDesc);var elUrl=h(m_state.settings.ResultContent.WebResultUrl);elTitleDiv.appendChild(elTitle);elItem.appendChild(elTitleDiv);elItem.appendChild(elDesc);elItem.appendChild(elUrl);elItem.id="AdsResultItemDiv"+i;elAdsDiv.appendChild(elItem);rgAdsResultItem.push({"item":elItem,"title":elTitle,"description":elDesc,"url":elUrl});}elAdsDiv.appendChild(elAdsCallbackCGif);}function w(x,y){x.onmouseover=function(){WLSearch.UI.ApplyStyles(x,m_state.settings.ResultFooter.ResultPageNumDivHover);if(x.id=="WLWebResultNextDiv")WLSearch.UI.ApplyStyles(x,m_state.settings.ResultFooter.ResultPageNextHover);else{if(x.id=="WLWebResultPreviousDiv")WLSearch.UI.ApplyStyles(x,m_state.settings.ResultFooter.ResultPagePreviousHover);}};x.onmouseout=function(){WLSearch.UI.ApplyStyles(x,m_state.settings.ResultFooter.ResultPageNumDiv);if(x.id=="WLWebResultNextDiv")WLSearch.UI.ApplyStyles(x,m_state.settings.ResultFooter.ResultPageNext);else{if(x.id=="WLWebResultPreviousDiv")WLSearch.UI.ApplyStyles(x,m_state.settings.ResultFooter.ResultPagePrevious);}};x.onclick=function(){Application.Search(y);};x.onkeypress=function(z){if(WLSearch.Browser.IsFireFoxMozilla()){if(z.keyCode==13){z.preventDefault();Application.Search(y);}}else{if(window.event.keyCode==13){window.event.returnValue=false;Application.Search(y);}}};}function A(B){B.onmouseover=null;B.onmouseout=null;B.onclick=null;B.onkeypress=null;}function C(D,E){D.innerHTML="";var elSpaceDiv=h(m_state.settings.SpaceDiv);var count=0;for(var i=0;i<E.length;i++){D.innerHTML+=E[i];++count;if(count%10==0||E[i]=="/"&&i>=9){D.appendChild(elSpaceDiv);count=1;}}}function F(G){var rectSearchBox=WLSearch.Browser.GetBoundingRect(G);var rectBody=WLSearch.Browser.GetBodyScrollRect();var floatSize=floatPane.GetSize();var iFloatWidth=floatSize.width;var iFloatHeight=floatSize.height;var iFloatXCenter=(iFloatWidth-rectSearchBox.width)/2;var iFloatLeft=rectSearchBox.left-iFloatXCenter;var iFloatRight=rectSearchBox.right+iFloatXCenter;var bUp=false;var pos=new WLSearch.UI.Point(0,0);if(iFloatLeft>=rectBody.left&&iFloatRight<=rectBody.right)pos.left=iFloatLeft;else{if(rectSearchBox.right-iFloatWidth<rectBody.left||iFloatLeft-rectBody.left<rectBody.right-iFloatRight){if(iFloatLeft>=rectBody.left)pos.left=iFloatLeft;else pos.left=rectSearchBox.left;}else pos.left=rectSearchBox.right-iFloatWidth;}if(rectSearchBox.top-rectBody.top<rectBody.bottom-rectSearchBox.bottom||rectBody.bottom-rectSearchBox.height-6<iFloatHeight||rectSearchBox.top-6<iFloatHeight)pos.top=rectSearchBox.bottom;else{pos.top=rectSearchBox.top-iFloatHeight-6;bUp=true;}return new WLSearch.UI.Rect(pos.left,pos.top,iFloatWidth,iFloatHeight);}this.Show=function(){var rect=F(c);if(m_state.config.appearance.autoHideTopControl==true){if(floatPane.Visible()){Application.ShowTopControl();Application.HideTopControl(rect);}else Application.HideTopControl(rect);}WLSearch.UI.SuspendLayout();this.Move(rect.left,rect.top);shadowPane.Show();floatPane.Show();WLSearch.UI.ResumeLayout();floatPane.PerformLayout();shadowPane.PerformLayout();if(m_state.firstShow)scopeBar.Resize(scopeBar.GetSize().width,scopeBar.GetProperty("scrollHeight"));else m_state.firstShow=false;};this.Hide=function(){if(m_state.config.appearance.autoHideTopControl==true)Application.ShowTopControl();Application.AbortAllRequest();shadowPane.Hide();floatPane.Hide();};this.Move=function(H,I){shadowPane.Move(H+4,I+6);floatPane.Move(H,I);};this.Visible=function(){return floatPane.Visible();};this.GetSize=function(){var size=floatPane.GetSize();size.width+=4;size.height+=6;return size;};this.Dispose=function(){shadowPane.Dispose();floatPane.Dispose();};this.GetActiveScope=function(){return m_state.activeScope;};this.RenderEmptyQueryView=function(){elResultHeaderNumberDiv.innerHTML="";elEmptyQueryDiv.style.display="block";elSpellCheckDiv.style.display="none";elNoResultDiv.style.display="none";var len=rgWebResultItem.length;for(var i=0;i<len;++i){rgWebResultItem[i].item.style.display="none";}elMoreResultDiv.style.display="none";resultFooter.Hide();adsView.Hide();elResultContentDiv.style.height="0px";};this.RenderNoResultView=function(){elNoResultDiv.style.display="block";elQueryStringDiv.innerHTML="";elQueryStringDiv.appendChild(document.createTextNode(Application.GetLastQuery()));elNoResultTryA.href=elTryThisQueryA.href;elResultHeaderNumberDiv.innerHTML=g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_ZERO_RESULT;elResultPaginationDiv.style.display="none";elResultContentDiv.style.height=elResultContentDiv.scrollHeight+"px";};this.RenderInitializeSearchView=function(){elResultHeaderNumberDiv.innerHTML=g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_LOADING;var len=rgWebResultItem.length;for(var i=0;i<len;++i){rgWebResultItem[i].item.style.display="none";}adsView.Hide();resultFooter.Show();elResultPaginationDiv.style.display="block";elResultNextDiv.style.display="none";elResultPreviousDiv.style.display="none";elEmptyQueryDiv.style.display="none";elNoResultDiv.style.display="none";elSpellCheckDiv.style.display="none";len=rgResultPageNumDivs.length;for(var i=0;i<len;++i){rgResultPageNumDivs[i].style.display="none";}elMoreResultDiv.style.display="none";elTryThisQueryA.style.display="block";var hint=g_WLSearchBoxConfig.CFG_LIVESEARCHLINK.split("{0}");var href=hint[0]+encodeURIComponent(Application.GetLastQuery())+hint[1];elTryThisQueryA.href=href;elResultContentDiv.style.height="0px";};this.RenderWebAdsView=function(J){var adsTotal=J.ads.results.length;if(adsTotal<=0)return;var adsNum=adsTotal;if(adsNum>2)adsNum=2;adsView.Show();var CGifSrc=J.ads.logUrl+"&DIS=";for(var i=0;i<adsNum;i++){rgAdsResultItem[i].item.style.display="block";rgAdsResultItem[i].title.innerHTML=J.ads.results[i].title;rgAdsResultItem[i].title.href=J.ads.results[i].url;if(J.ads.results[i].description){rgAdsResultItem[i].description.style.display="block";rgAdsResultItem[i].description.innerHTML=J.ads.results[i].description;}else rgAdsResultItem[i].description.style.display="none";var strDisplayUrl=J.ads.results[i].displayUrl;if(WLSearch.Browser.IsFireFoxMozilla())C(rgAdsResultItem[i].url,strDisplayUrl);else rgAdsResultItem[i].url.innerHTML=strDisplayUrl;if(i>0)CGifSrc+=";";CGifSrc+=J.ads.results[i].adsID+"-SB-"+(i+1)+"-"+J.ads.results[i].listingID;}for(;i<2;++i){rgAdsResultItem[i].item.style.display="none";}for(i=adsNum;i<adsTotal;++i){CGifSrc+=";"+J.ads.results[i].adsID+"-BU--"+J.ads.results[i].listingID;}elAdsCallbackCGif.src=CGifSrc;};this.RenderSpellCheckView=function(K,L){if(K.spell){var spellHtmlValue="";var spellRawValue="";var len=K.spell.length;for(var i=0;i<len;++i){spellHtmlValue+=K.spell[i].htmlValue;spellRawValue+=K.spell[i].rawValue;}elSpellCheckDiv.style.display="block";elSpellCheckLink.innerHTML=spellHtmlValue;elSpellCheckLink.onclick=function(){Application.Search(1,spellRawValue);};elResultContentDiv.style.height=elResultContentDiv.scrollHeight+"px";}};this.RenderWebResultView=function(M,N){if(M.ads)this.RenderWebAdsView(M);else adsView.Hide();if(M.spell){if(M.web&&M.web.total!=0&&M.web.offset<=1||!M.web||M.web.total==0)this.RenderSpellCheckView(M,N);}if(M.web&&M.web.total!=0){var hint=g_WLSearchBoxLocStrings.LOC_SEARCHBOX_FLOAT_RESULT_HINT.split("{0}");elResultHeaderNumberDiv.innerHTML=hint[0]+M.web.totalLocaleString+hint[1];for(var i=0;i<M.web.results.length&&i<N.Constants.MAX_RESULT_PER_PAGE;i++){rgWebResultItem[i].item.style.display="block";rgWebResultItem[i].title.innerHTML=M.web.results[i].title;rgWebResultItem[i].title.href=M.web.results[i].url;if(M.web.results[i].description){rgWebResultItem[i].description.style.display="block";rgWebResultItem[i].description.innerHTML=M.web.results[i].description;}else rgWebResultItem[i].description.style.display="none";var strDisplayUrl=M.web.results[i].displayUrl;if(WLSearch.Browser.IsFireFoxMozilla())C(rgWebResultItem[i].url,strDisplayUrl);else rgWebResultItem[i].url.innerHTML=strDisplayUrl;}if(M.web.results.length<=2){elMoreResultDiv.style.display="block";elMoreResultA.href=elTryThisQueryA.href;}var curOffset=M.web.offset;var totalResultNum=M.web.total;if(totalResultNum>N.Constants.MAX_RESULT_NUMBER)totalResultNum=N.Constants.MAX_RESULT_NUMBER;if(curOffset==1&&totalResultNum<=N.Constants.MAX_RESULT_PER_PAGE)return;var totalPageNum=Math.ceil(totalResultNum/N.Constants.MAX_RESULT_PER_PAGE);var previousPageNum=Math.floor((N.Constants.MAX_PAGE_NUM-1)/2);var nextPageNum=N.Constants.MAX_PAGE_NUM-previousPageNum-1;var currPageNo=Math.floor(curOffset/N.Constants.MAX_RESULT_PER_PAGE)+1;var startPageNo=currPageNo-previousPageNum;var endPageNo=currPageNo+nextPageNum;if(endPageNo>totalPageNum){endPageNo=totalPageNum;startPageNo=endPageNo-nextPageNum-previousPageNum;}if(startPageNo<1){startPageNo=1;endPageNo=startPageNo+nextPageNum+previousPageNum;}if(endPageNo>totalPageNum)endPageNo=totalPageNum;if(currPageNo>1){elResultPreviousDiv.style.display="block";w(elResultPreviousDiv,(currPageNo-2)*N.Constants.MAX_RESULT_PER_PAGE+1);}var iOffset=(startPageNo-1)*N.Constants.MAX_RESULT_PER_PAGE+1;var i=0;while(startPageNo+i<=endPageNo){var iPageNo=startPageNo+i;rgResultPageNumDivs[i].style.display="block";rgResultPageNumDivs[i].innerHTML=iPageNo.toString();if(iPageNo!=currPageNo){w(rgResultPageNumDivs[i],iOffset);WLSearch.UI.ApplyStyles(rgResultPageNumDivs[i],m_state.settings.ResultFooter.ResultPageNumDiv);}else{A(rgResultPageNumDivs[i]);WLSearch.UI.ApplyStyles(rgResultPageNumDivs[i],m_state.settings.ResultFooter.ResultPageNumDivSelect);}iOffset+=N.Constants.MAX_RESULT_PER_PAGE;++i;}if(currPageNo<endPageNo){elResultNextDiv.style.display="block";w(elResultNextDiv,currPageNo*N.Constants.MAX_RESULT_PER_PAGE+1);}}else this.RenderNoResultView();elResultContentDiv.style.height=elResultContentDiv.scrollHeight+"px";};};WLSearchBox.Application=function(){var m_this=this;var m_state={};m_state.config=null;m_state.rgSearchHandler=null;m_state.lastQuery="";var c_MAX_QUERY_LENGTH=200;var elSearchBox=document.getElementById("WLSearchBoxPlaceholder");var elSearchBoxInput=document.getElementById("WLSearchBoxInput");var elSearchBoxButton=document.getElementById("WLSearchBoxButton");var topControlList=null;var objRequestBuilder=new JsonRequestBuilder(30000,"utf-8");O();function O(){function P(Q,R){for(var paraName in R){if(Q[paraName])R[paraName]=Q[paraName];}}if(WLSearchBoxConfiguration){if(WLSearchBoxConfiguration.appearance)P(WLSearchBoxConfiguration.appearance,WLSearchBoxStandardConfiguration.appearance);if(WLSearchBoxConfiguration.global)P(WLSearchBoxConfiguration.global,WLSearchBoxStandardConfiguration.global);if(WLSearchBoxConfiguration.scopes)WLSearchBoxStandardConfiguration.scopes=WLSearchBoxConfiguration.scopes;}WLSearchBoxConfiguration=WLSearchBoxStandardConfiguration;m_state.config=WLSearchBoxConfiguration;}try{WLSearchBoxTheme=eval("WLSearchBoxTheme"+m_state.config.appearance.theme);}catch(e){WLSearchBoxTheme=WLSearchBoxThemeBlue;}WLSearchBoxTheme.FontSize=g_WLSearchBoxConfig.FontSize;WLSearchBoxTheme.FontFamily=g_WLSearchBoxConfig.FontFamily;m_state.rgSearchHandler=new Array();var len=m_state.config.scopes.length;for(var i=0;i<len;++i){var type=m_state.config.scopes[i].type;if(type=="web")m_state.rgSearchHandler.push(cb);else m_state.rgSearchHandler.push(cb);}var floatPane=new WLSearchBox.FloatPane(this,elSearchBox,m_state.config);if(WLSearch.Browser.IsFireFoxMozilla())elSearchBoxInput.setAttribute("autocomplete","off");elSearchBoxInput.disabled=false;elSearchBoxInput.maxLength=c_MAX_QUERY_LENGTH;elSearchBoxInput.value="";WLSearch.Browser.AttachEvent("onresize",S);function S(){if(floatPane.Visible())floatPane.Show();}elSearchBoxButton.onclick=function(T){if(WLSearch.Browser.IsFireFoxMozilla())T.preventDefault();else window.event.returnValue=false;m_this.Search();};elSearchBoxInput.onkeypress=function(U){if(WLSearch.Browser.IsFireFoxMozilla()){if(U.keyCode==13){U.preventDefault();m_this.Search();}if(U.keyCode==27)floatPane.Hide();}else{if(window.event.keyCode==13){window.event.returnValue=false;m_this.Search();}if(window.event.keyCode==27)floatPane.Hide();}};window.onunload=function(V){WLSearch.Browser.DetachEvent("onresize",S);elSearchBoxButton.onclick=null;elSearchBoxInput.onkeypress=null;floatPane.Dispose();};this.Search=function(W,X){this.AbortAllRequest();if(X)elSearchBoxInput.value=X;else X=elSearchBoxInput.value;var intScopeId=floatPane.GetActiveScope();var strSearchParam=m_state.config.scopes[intScopeId].searchParam;if(!strSearchParam)strSearchParam="";m_state.rgSearchHandler[intScopeId](objRequestBuilder,m_state.config.global.serverDNS,X,strSearchParam,intScopeId,W);};this.GetLastQuery=function(){return m_state.lastQuery;};this.AbortAllRequest=function(){objRequestBuilder.AbortAll();};this.ShowTopControl=function(){if(topControlList){var len=topControlList.length;for(var i=0;i<len;++i){try{topControlList[i].style.visibility=topControlList[i].getAttribute("wlRawVisibility");}catch(e){}}topControlList=null;}};this.HideTopControl=function(Y){topControlList=new Array();Z("object",Y);Z("iframe",Y);Z("select",Y);Z("applet",Y);Z("embed",Y);};function Z(ab,bb){var controlList=document.getElementsByTagName(ab);var len=controlList.length;for(var i=0;i<len;++i){if(controlList[i].style.visibility!="hidden"&&controlList[i].style.display!="none"){rectControl=WLSearch.Browser.GetBoundingRect(controlList[i]);var bInterX=true;var bInterY=true;if(rectControl.right<bb.left||rectControl.left>bb.right)bInterX=false;if(rectControl.top>bb.bottom||rectControl.bottom<bb.top)bInterY=false;if(bInterX&&bInterY){controlList[i].setAttribute("wlRawVisibility",controlList[i].style.visibility);controlList[i].style.visibility="hidden";topControlList.push(controlList[i]);}}}}function cb(eb,gb,hb,jb,kb,lb){var Constants={"MAX_PAGE_NUM":5,"MAX_RESULT_PER_PAGE":10,"MAX_RESULT_NUMBER":1000};if(!lb)lb=1;floatPane.Show();if(hb==""){floatPane.RenderEmptyQueryView();return;}var strQueryURL="http://"+gb+"/json.aspx?sourcetype=spell&sourcetype=web&sourcetype=ads&q="+encodeURIComponent(hb)+"&q1="+encodeURIComponent(jb)+"&first="+lb.toString()+"&count="+Constants.MAX_RESULT_PER_PAGE+"&adscount=2&locale="+m_state.config.global.market+"&charset=utf-8&FORM="+m_state.config.global.jsonFormCode;var objRequest=eb.CreateRequest(strQueryURL,"LiveSearchGetResponse",{"Constants":Constants},mb,7);m_state.lastQuery=hb;floatPane.RenderInitializeSearchView();window.setTimeout(function(){objRequest.Execute();},10);}function mb(nb,ob,pb){if(pb=="aborted"||!floatPane.Visible())return;if(pb=="complete"||pb=="loaded")floatPane.RenderWebResultView(nb,ob);else floatPane.RenderNoResultView();}};function WLSearchBoxScriptReady(qb){var isLoaded=true;if(qb!=null&&typeof qb!="undefined")for(var i=0;i<qb.length;i++){if(qb[i].loadState!="loaded"){isLoaded=false;break;}}if(isLoaded)g_objWLSearchBox=new WLSearchBox.Application();}